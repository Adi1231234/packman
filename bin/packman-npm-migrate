#!/usr/bin/env node

const program = require('commander');

const log = require('../lib/core/logger');
const { initializeCommand } = require('../lib/core/initializer');
initializeCommand(program, 'migrate');

const commands = require('../lib/npm/migrate/commands');

program
    .command('package <name> [version]')
    // .command('<sourceRegistry> [targetRegistry]')
    .description('migrate packages from one registry to another')
    .option('-s, --source <sourceRegistry>', 'the source registry from which to migrate packages (mandatory)')
    .option('-t, --target <targetRegistry>', 'the target registry the packages will be migrated, defaults to current registry')
    .action((name, version, { source, target }) => {
        log(['migrate package'], 'name', name);
        log(['migrate package'], 'version', version);
        log(['migrate package'], 'source', source);
        log(['migrate package'], 'target', target);
        commands.migratePackageCommand(name, version, source, target);
    });

program.parse(process.argv);
